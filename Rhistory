library(Seurat)
library(patchwork)
library(tidyverse)
library(ggplot2)
ll
Jansky_medulla <- readRDS("/home/shunyaanasuma/Jansky/adrenal_medulla_Seurat.RDS")
Jansky_medulla <- readRDS("/home/shunyaasanuma/Jansky/adrenal_medulla_Seurat.RDS")
Adameyko_whole <- readRDS("/home/shunyaasanuma/Seurat/adrenal.human.seurat.scrublet.rds")
Adameyko_medulla <- subset(x = Adameyko_whole, subset = fate %in% c("chromaffin", "sympathoblasts", "SCP"))
summary(rownames(Jansky_medulla@meta.data) == names(Jansky_medulla@active.ident))
Jansky_medulla@meta.data <- Jansky_medulla@meta.data %>%
  mutate(fate = Jansky_medulla@active.ident)
Jansky_medulla@meta.data %>% select(fate)
Jansky_medulla@meta.data <-Jansky_medulla@meta.data %>% mutate(dataset = "Jansky")
all_data_list <- list(Jansky_medulla, Adameyko_medulla)
all_data_list
names(all_data_list) <- c("Jansky_medulla", "Adameyko_medulla")
all_data_list
remove(Jansky_medulla)
remove(Adameyko_whole)
remove(Adameyko_medulla)
all_data_list <- lapply(X = all_data_list, FUN = function(x) {
    x <- NormalizeData(x)
    x <- FindVariableFeatures(x, selection.method = "vst", nfeatures = 2000)
})
features <- SelectIntegrationFeatures(object.list = all_data_list)
head(features)
anchors <- FindIntegrationAnchors(object.list = all_data_list, anchor.features = features)
combined <- IntegrateData(anchorset = anchors)
combined
DefaultAssay(combined) <- "integrated"
combined <- ScaleData(combined, verbose = FALSE)
combined <- RunPCA(combined, npcs = 30, verbose = FALSE)
combined <- RunUMAP(combined, reduction = "pca", dims = 1:30)
combined <- FindNeighbors(combined, reduction = "pca", dims = 1:30)
combined <- FindClusters(combined, resolution = 0.5)
#SeuratDisk::SaveH5Seurat(object = combined, filename = "Jansky_Adameyko_integrated.H5Seurat")
ls()
getwd()
SeuratDisk::SaveH5Seurat(object = combined, filename = "Jansky_Adameyko_integrated.H5Seurat")
install.packages("SeuratDisk")
version)_
version
install.packages("seurat-disk")
remotes::install_github("mojaveazure/seurat-disk")
install.packages("remotes")
remotes::install_github("mojaveazure/seurat-disk")
SeuratDisk::SaveH5Seurat(object = combined, filename = "Jansky_Adameyko_integrated.H5Seurat")
quit()
